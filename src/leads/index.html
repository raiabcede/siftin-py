<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-theme="Green_Theme" class="selected"
	data-layout="vertical" data-boxed-layout="full" data-card="shadow">

	<head>
		@@include("../partials/head.html")
		<title>Leads Library - Siftin</title>
	</head>

	<body class="DEFAULT_THEME  bg-white dark:bg-dark">
		<main>
			<!--start the project-->
			<div id="main-wrapper" class="flex">

				<aside id="application-sidebar-brand"
					class="hs-overlay hs-overlay-open:translate-x-0 -translate-x-full xl:rtl:-translate-x-0 rtl:translate-x-full  left-0 rtl:left-auto rtl:right-0 transform hidden xl:block xl:translate-x-0 xl:end-auto xl:bottom-0 fixed top-0 with-vertical  left-sidebar transition-all duration-300 h-screen z-[2] flex-shrink-0 border-r rtl:border-l rtl:border-r-0 w-[270px] border-border dark:border-darkborder bg-white dark:bg-dark">
					@@include("../partials/sidebar.html",{ "page": "leads" })
				</aside>
				<div class="page-wrapper w-full" role="main">
					<!--  Header Start -->
					<header
						class="sticky top-header top-0 inset-x-0 z-[1] flex flex-wrap md:justify-start md:flex-nowrap text-sm bg-white dark:bg-dark ">
					<div
						class="with-vertical w-full">@@include("../partials/header.html")</div>
					<div class="with-horizontal w-full">
						<div class="bg-white dark:bg-dark shadow-md dark:shadow-dark-md">
							<div class="container">
								@@include("../partials/horizontal-header.html")
							</div>
						</div>
					</div>
					</header>
					<!--  Header End -->

					<!-- Horizontal Header Menu -->
					<aside class="with-horizontal lg:flex hidden">
						@@include("../partials/horizontal-sidebar.html", { "page": "leads",
						})
					</aside>
					<!-- Horizontal Header Menu End -->

					<!-- Main Content -->
					<main class="h-full max-w-full pt-6">
						<div class="container full-container py-5">
							<!-- Page Title -->
							<div class="mb-6">
								<div class="flex items-center justify-between mb-2">
									<div>
										<h1 class="text-3xl font-bold text-dark dark:text-white mb-2">Leads Library</h1>
										<p class="text-base text-link dark:text-darklink">Manage and filter your saved leads</p>
									</div>
									<div class="flex items-center gap-3">
										<button onclick="toggleFiltersPanel()" class="btn btn-outline flex items-center">
											<i class="ti ti-filter mr-2"></i> Filters
									</button>
										<a href="../new-capture/" class="btn btn-primary flex items-center">
											<i class="ti ti-circle-plus mr-2"></i> New Capture
										</a>
									</div>
								</div>
							</div>

							<!-- Filters and Results Section -->
							<div class="flex gap-6">
								<!-- Left Sidebar - Saved Views and Filters -->
								<aside id="filters-panel" class="w-64 flex-shrink-0">
									<div class="card sticky top-24">
										<div class="card-body space-y-6">
											<!-- Saved Views -->
											<div>
												<h3 class="text-sm font-semibold text-dark dark:text-white mb-3">Saved Views</h3>
												<div class="space-y-1">
													<button onclick="loadSavedView('all')" class="saved-view-btn w-full text-left px-3 py-2 text-sm rounded-md hover:bg-lightprimary dark:hover:bg-darkprimary transition-colors active-view" data-view="all">
														All Leads
													</button>
													<button onclick="loadSavedView('high-match')" class="saved-view-btn w-full text-left px-3 py-2 text-sm rounded-md hover:bg-lightprimary dark:hover:bg-darkprimary transition-colors" data-view="high-match">
														High Match ≥80
													</button>
													<button onclick="loadSavedView('us-sdr')" class="saved-view-btn w-full text-left px-3 py-2 text-sm rounded-md hover:bg-lightprimary dark:hover:bg-darkprimary transition-colors" data-view="us-sdr">
														US SDR Managers
													</button>
													<button onclick="loadSavedView('email-found')" class="saved-view-btn w-full text-left px-3 py-2 text-sm rounded-md hover:bg-lightprimary dark:hover:bg-darkprimary transition-colors" data-view="email-found">
														Email Found
													</button>
													<button onclick="loadSavedView('1st-connections')" class="saved-view-btn w-full text-left px-3 py-2 text-sm rounded-md hover:bg-lightprimary dark:hover:bg-darkprimary transition-colors" data-view="1st-connections">
														1st Connections
													</button>
												</div>
											</div>

											<!-- Search -->
											<div>
												<h3 class="text-sm font-semibold text-dark dark:text-white mb-2">Search</h3>
												<div class="relative">
													<i class="ti ti-search absolute left-3 top-1/2 transform -translate-y-1/2 text-link dark:text-darklink"></i>
													<input 
														type="text" 
														id="search-input"
														placeholder="Search" 
														class="w-full pl-10 pr-4 py-2 border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
													/>
												</div>
											</div>

											<!-- Filters -->
											<div>
												<h3 class="text-sm font-semibold text-dark dark:text-white mb-3">Filters</h3>
												<div class="space-y-4">
													<!-- Industry -->
													<div>
														<label class="block text-xs font-medium text-link dark:text-darklink mb-2">Industry</label>
														<select id="industry-filter" onchange="applyFilters()" class="w-full px-3 py-2 text-sm border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
															<option value="">All Industries</option>
															<option value="SaaS">SaaS</option>
															<option value="Fintech SaaS">Fintech SaaS</option>
															<option value="Enterprise Software">Enterprise Software</option>
															<option value="Data Analytics">Data Analytics</option>
															<option value="Cloud Infrastructure">Cloud Infrastructure</option>
															<option value="Marketing Tech">Marketing Tech</option>
															<option value="B2B SaaS">B2B SaaS</option>
															<option value="Sales Tech">Sales Tech</option>
															<option value="Fintech">Fintech</option>
															<option value="Analytics SaaS">Analytics SaaS</option>
														</select>
													</div>

													<!-- Company Size -->
													<div>
														<label class="block text-xs font-medium text-link dark:text-darklink mb-2">Company Size</label>
														<select id="company-size-filter" onchange="applyFilters()" class="w-full px-3 py-2 text-sm border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
															<option value="">All Sizes</option>
															<option value="1-10">1-10</option>
															<option value="11-50">11-50</option>
															<option value="51-200">51-200</option>
															<option value="201-500">201-500</option>
															<option value="501-1000">501-1,000</option>
															<option value="1001-5000">1,001-5,000</option>
															<option value="5001+">5,001+</option>
														</select>
													</div>

													<!-- Location -->
													<div>
														<label class="block text-xs font-medium text-link dark:text-darklink mb-2">Location</label>
														<select id="location-filter" onchange="applyFilters()" class="w-full px-3 py-2 text-sm border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
															<option value="">All Locations</option>
															<option value="US">United States</option>
															<option value="New York">New York, NY</option>
															<option value="San Francisco">San Francisco, CA</option>
															<option value="Austin">Austin, TX</option>
															<option value="Chicago">Chicago, IL</option>
															<option value="Miami">Miami, FL</option>
															<option value="Seattle">Seattle, WA</option>
															<option value="Boston">Boston, MA</option>
															<option value="Remote">Remote (US)</option>
														</select>
													</div>

													<!-- Email Status -->
													<div>
														<label class="block text-xs font-medium text-link dark:text-darklink mb-2">Email Status</label>
														<select id="email-status-filter" onchange="applyFilters()" class="w-full px-3 py-2 text-sm border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
															<option value="">All Status</option>
															<option value="found">Found</option>
															<option value="not-found">Not Found</option>
															<option value="unknown">Unknown</option>
														</select>
													</div>

													<!-- Connection Level -->
													<div>
														<label class="block text-xs font-medium text-link dark:text-darklink mb-2">Connection Level</label>
														<select id="connection-filter" onchange="applyFilters()" class="w-full px-3 py-2 text-sm border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
															<option value="">All Levels</option>
															<option value="1st">1st</option>
															<option value="2nd">2nd</option>
															<option value="3rd">3rd</option>
														</select>
													</div>

													<!-- Match Score -->
													<div>
														<div class="flex items-center justify-between mb-2">
															<label class="block text-xs font-medium text-link dark:text-darklink">Match Score</label>
															<span class="text-xs text-link dark:text-darklink" id="match-score-value">0%+</span>
														</div>
														<input 
															type="range" 
															id="match-score-slider"
															min="0" 
															max="100" 
															value="0" 
															class="w-full h-2 bg-gray-200 dark:bg-darkborder rounded-lg appearance-none cursor-pointer accent-primary"
															oninput="updateMatchScore(this.value)"
														/>
													</div>
												</div>
											</div>
										</div>
									</div>
								</aside>

								<!-- Main Content Area -->
								<div class="flex-1">
									<!-- Results Header -->
									<div class="flex items-center justify-between mb-4">
										<div class="flex items-center gap-4">
											<span class="text-sm font-medium text-dark dark:text-white" id="leads-count">25 Leads</span>
										</div>
										<div class="flex items-center gap-2">
											<label class="flex items-center gap-2 cursor-pointer">
												<input type="checkbox" id="select-all-checkbox" onchange="toggleSelectAll(this.checked)" class="cursor-pointer">
												<span class="text-sm text-link dark:text-darklink">Select All</span>
											</label>
										</div>
									</div>

									<!-- Leads Table -->
									<div class="card">
										<div class="card-body p-0">
											<div class="overflow-x-auto">
												<table class="w-full">
													<thead class="bg-lightprimary dark:bg-darkprimary">
														<tr>
															<th class="px-4 py-3 text-left">
																<input type="checkbox" id="table-select-all" onchange="toggleSelectAll(this.checked)" class="cursor-pointer">
															</th>
															<th class="px-4 py-3 text-left text-xs font-semibold text-dark dark:text-white uppercase">LEAD</th>
															<th class="px-4 py-3 text-left text-xs font-semibold text-dark dark:text-white uppercase">COMPANY</th>
															<th class="px-4 py-3 text-left text-xs font-semibold text-dark dark:text-white uppercase">LOCATION</th>
															<th class="px-4 py-3 text-left text-xs font-semibold text-dark dark:text-white uppercase">MATCH</th>
															<th class="px-4 py-3 text-left text-xs font-semibold text-dark dark:text-white uppercase">EMAIL</th>
															<th class="px-4 py-3 text-left text-xs font-semibold text-dark dark:text-white uppercase">CONNECTION</th>
														</tr>
													</thead>
													<tbody id="leads-table-body" class="divide-y divide-border dark:divide-darkborder">
														<!-- Leads will be dynamically inserted here -->
													</tbody>
												</table>
									</div>
								</div>
							</div>

							<!-- Empty State -->
							<div id="empty-state" class="hidden">
								<div class="card">
									<div class="card-body text-center py-12">
												<i class="ti ti-users text-6xl text-link dark:text-darklink mb-4 opacity-50"></i>
												<h3 class="text-xl font-semibold text-dark dark:text-white mb-2">No leads found</h3>
												<p class="text-link dark:text-darklink">Try adjusting your filters or search criteria.</p>
											</div>
										</div>
									</div>
								</div>
							</div>

						</div>
					</main>
					<!-- Main Content End -->

				</div>
			</div>
			<!--end of project-->
		</main>
		@@include("../partials/header-components/mobile-menu.html")
		@@include("../partials/header-components/dd-searchbar.html")
		@@include("../partials/header-components/dd-cart.html")
		@@include("../partials/customizer.html")
		@@include("../partials/scripts.html")
		
		<script>
			// API Configuration
			const API_BASE_URL = 'http://localhost:8000';
			
			// Application state
			let selectedLeads = [];
			let allLeads = [];
			let filteredLeads = [];
			let activeFilters = {
				search: '',
				savedView: 'all',
				industry: '',
				companySize: '',
				location: '',
				emailStatus: '',
				connection: '',
				matchScore: 0
			};

			// Mock data for demonstration (replace with API call)
			const mockLeads = [
				{ id: 1, name: 'Jordan Blake', title: 'SDR Manager', company: 'CloudNova', companySize: '51-200', industry: 'SaaS', location: 'New York, NY', matchScore: 87, emailStatus: 'unknown', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-1.jpg' },
				{ id: 2, name: 'Priya Shah', title: 'Head of Sales Development', company: 'FinPilot', companySize: '201-500', industry: 'Fintech SaaS', location: 'Remote (US)', matchScore: 92, emailStatus: 'found', connection: '1st', profileImage: '@@webRoot/assets/images/profile/user-2.jpg' },
				{ id: 3, name: 'Leo Martínez', title: 'RevOps Lead', company: 'GrowthForge', companySize: '11-50', industry: 'SaaS', location: 'Austin, TX', matchScore: 78, emailStatus: 'not-found', connection: '3rd', profileImage: '@@webRoot/assets/images/profile/user-3.jpg' },
				{ id: 4, name: 'Sarah Chen', title: 'VP of Sales', company: 'TechFlow', companySize: '101-250', industry: 'B2B SaaS', location: 'San Francisco, CA', matchScore: 85, emailStatus: 'found', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-4.jpg' },
				{ id: 5, name: 'Marcus Johnson', title: 'Sales Development Representative', company: 'DataSync', companySize: '51-200', industry: 'Data Analytics', location: 'Chicago, IL', matchScore: 74, emailStatus: 'unknown', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-5.jpg' },
				{ id: 6, name: 'Emma Rodriguez', title: 'Founder & CEO', company: 'StartupFlow', companySize: '11-50', industry: 'SaaS', location: 'Miami, FL', matchScore: 96, emailStatus: 'found', connection: '1st', profileImage: '@@webRoot/assets/images/profile/user-6.jpg' },
				{ id: 7, name: 'David Kim', title: 'Senior SDR', company: 'CloudScale', companySize: '201-500', industry: 'Cloud Infrastructure', location: 'Seattle, WA', matchScore: 81, emailStatus: 'unknown', connection: '3rd', profileImage: '@@webRoot/assets/images/profile/user-7.jpg' },
				{ id: 8, name: 'Rachel Green', title: 'Head of Demand Generation', company: 'MarketFlow', companySize: '51-200', industry: 'Marketing Tech', location: 'Boston, MA', matchScore: 73, emailStatus: 'found', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-8.jpg' },
				{ id: 9, name: 'Alex Thompson', title: 'Business Development Manager', company: 'TechCorp', companySize: '501-1000', industry: 'Enterprise Software', location: 'Denver, CO', matchScore: 69, emailStatus: 'not-found', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-1.jpg' },
				{ id: 10, name: 'Lisa Wang', title: 'Sales Manager', company: 'InnovateTech', companySize: '101-250', industry: 'B2B SaaS', location: 'Portland, OR', matchScore: 83, emailStatus: 'found', connection: '1st', profileImage: '@@webRoot/assets/images/profile/user-2.jpg' },
				{ id: 11, name: 'Michael Brown', title: 'SDR Team Lead', company: 'SalesForce Pro', companySize: '201-500', industry: 'Sales Tech', location: 'Atlanta, GA', matchScore: 88, emailStatus: 'unknown', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-3.jpg' },
				{ id: 12, name: 'Jennifer Davis', title: 'Co-Founder', company: 'FinanceFlow', companySize: '11-50', industry: 'Fintech', location: 'New York, NY', matchScore: 94, emailStatus: 'found', connection: '1st', profileImage: '@@webRoot/assets/images/profile/user-4.jpg' },
				{ id: 13, name: 'Robert Wilson', title: 'VP of Business Development', company: 'ScaleUp', companySize: '101-250', industry: 'B2B SaaS', location: 'Dallas, TX', matchScore: 76, emailStatus: 'not-found', connection: '3rd', profileImage: '@@webRoot/assets/images/profile/user-5.jpg' },
				{ id: 14, name: 'Amanda Lee', title: 'Sales Development Director', company: 'GrowthTech', companySize: '51-200', industry: 'Marketing SaaS', location: 'Phoenix, AZ', matchScore: 90, emailStatus: 'found', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-6.jpg' },
				{ id: 15, name: 'Christopher Taylor', title: 'Senior Business Development Rep', company: 'TechSolutions', companySize: '201-500', industry: 'Enterprise Software', location: 'Las Vegas, NV', matchScore: 71, emailStatus: 'unknown', connection: '2nd', profileImage: '@@webRoot/assets/images/profile/user-7.jpg' },
				{ id: 16, name: 'Nicole Martinez', title: 'Founder', company: 'DataDriven', companySize: '11-50', industry: 'Analytics SaaS', location: 'Remote (US)', matchScore: 95, emailStatus: 'found', connection: '1st', profileImage: '@@webRoot/assets/images/profile/user-8.jpg' }
			];
			
			// Helper function for API calls
			async function apiCall(endpoint, method = 'GET', data = null) {
				try {
					const options = {
						method,
						headers: {
							'Content-Type': 'application/json',
						}
					};
					
					if (data) {
						options.body = JSON.stringify(data);
					}
					
					const response = await fetch(`${API_BASE_URL}${endpoint}`, options);
					
					if (!response.ok) {
						const errorData = await response.json().catch(() => ({ detail: response.statusText }));
						throw new Error(errorData.detail || `HTTP error! status: ${response.status}`);
					}
					
					return await response.json();
				} catch (error) {
					console.error('[API] Error:', error);
					throw error;
				}
			}

			// Load leads from API
			async function loadLeads() {
				try {
					// Try to load from API, fallback to mock data
					const response = await apiCall('/api/leads');
					allLeads = response.leads || mockLeads;
				} catch (error) {
					console.log('[Leads] Using mock data:', error.message);
					allLeads = mockLeads;
				}
				
				applyFilters();
			}

			// Load saved view
			function loadSavedView(view) {
				activeFilters.savedView = view;
				
				// Update active view button
				document.querySelectorAll('.saved-view-btn').forEach(btn => {
					btn.classList.remove('active-view', 'bg-primary', 'text-white');
					btn.classList.add('text-link', 'dark:text-darklink');
				});
				document.querySelector(`[data-view="${view}"]`).classList.add('active-view', 'bg-primary', 'text-white');
				document.querySelector(`[data-view="${view}"]`).classList.remove('text-link', 'dark:text-darklink');
				
				// Apply view-specific filters
				switch(view) {
					case 'all':
						activeFilters.matchScore = 0;
						activeFilters.emailStatus = '';
						activeFilters.location = '';
						break;
					case 'high-match':
						activeFilters.matchScore = 80;
						break;
					case 'us-sdr':
						activeFilters.location = 'US';
						break;
					case 'email-found':
						activeFilters.emailStatus = 'found';
						break;
					case '1st-connections':
						activeFilters.connection = '1st';
						break;
				}
				
				// Update filter UI
				document.getElementById('match-score-slider').value = activeFilters.matchScore;
				document.getElementById('match-score-value').textContent = `${activeFilters.matchScore}%+`;
				document.getElementById('email-status-filter').value = activeFilters.emailStatus;
				document.getElementById('location-filter').value = activeFilters.location;
				document.getElementById('connection-filter').value = activeFilters.connection;
				
				applyFilters();
			}

			// Toggle filters panel (for mobile)
			function toggleFiltersPanel() {
				const panel = document.getElementById('filters-panel');
				panel.classList.toggle('hidden');
			}

			// Update match score
			function updateMatchScore(value) {
				activeFilters.matchScore = parseInt(value);
				document.getElementById('match-score-value').textContent = `${value}%+`;
				applyFilters();
			}

			// Apply filters
			function applyFilters() {
				// Get search input
				activeFilters.search = document.getElementById('search-input').value.toLowerCase();
				
				// Get filter values
				activeFilters.industry = document.getElementById('industry-filter').value;
				activeFilters.companySize = document.getElementById('company-size-filter').value;
				activeFilters.location = document.getElementById('location-filter').value;
				activeFilters.emailStatus = document.getElementById('email-status-filter').value;
				activeFilters.connection = document.getElementById('connection-filter').value;
				
				// Filter leads
				filteredLeads = allLeads.filter(lead => {
					// Search filter
					if (activeFilters.search) {
						const searchText = `${lead.name || ''} ${lead.title || ''} ${lead.company || ''}`.toLowerCase();
						if (!searchText.includes(activeFilters.search)) {
							return false;
						}
					}
					
					// Industry filter
					if (activeFilters.industry && lead.industry !== activeFilters.industry) {
						return false;
					}
					
					// Company size filter
					if (activeFilters.companySize && lead.companySize !== activeFilters.companySize) {
						return false;
					}
					
					// Location filter
					if (activeFilters.location) {
						if (activeFilters.location === 'US' && !lead.location.includes('US') && !lead.location.includes('New York') && !lead.location.includes('San Francisco') && !lead.location.includes('Austin') && !lead.location.includes('Chicago') && !lead.location.includes('Miami') && !lead.location.includes('Seattle') && !lead.location.includes('Boston')) {
							return false;
						} else if (activeFilters.location !== 'US' && !lead.location.includes(activeFilters.location)) {
							return false;
						}
					}
					
					// Email status filter
					if (activeFilters.emailStatus && lead.emailStatus !== activeFilters.emailStatus) {
						return false;
					}
					
					// Connection filter
					if (activeFilters.connection && lead.connection !== activeFilters.connection) {
						return false;
					}
					
					// Match score filter
					if (lead.matchScore < activeFilters.matchScore) {
						return false;
					}
					
					return true;
				});
				
				// Update UI
				updateLeadsDisplay();
			}

			// Update leads display
			function updateLeadsDisplay() {
				const leadsCount = document.getElementById('leads-count');
				leadsCount.textContent = `${filteredLeads.length} Lead${filteredLeads.length !== 1 ? 's' : ''}`;
				
				const emptyState = document.getElementById('empty-state');
				const table = document.querySelector('.card .overflow-x-auto');
				
				if (filteredLeads.length === 0) {
					emptyState.classList.remove('hidden');
					if (table) table.closest('.card').classList.add('hidden');
				} else {
					emptyState.classList.add('hidden');
					if (table) table.closest('.card').classList.remove('hidden');
					renderLeadsTable();
				}
			}

			// Render leads table
			function renderLeadsTable() {
				const tbody = document.getElementById('leads-table-body');
				tbody.innerHTML = filteredLeads.map(lead => {
					const initials = lead.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
					const profileImage = lead.profileImage || `@@webRoot/assets/images/profile/user-${(lead.id % 8) + 1}.jpg`;
					
					return `
						<tr class="hover:bg-lightprimary dark:hover:bg-darkprimary transition-colors">
							<td class="px-4 py-3">
								<input type="checkbox" class="lead-checkbox" value="${lead.id}" onchange="toggleLeadSelection('${lead.id}')" ${selectedLeads.includes(lead.id) ? 'checked' : ''}>
							</td>
							<td class="px-4 py-3">
								<div class="flex items-center gap-3">
									<div class="w-10 h-10 rounded-full bg-lightprimary dark:bg-darkprimary flex items-center justify-center text-sm font-semibold text-primary overflow-hidden">
										<img src="${profileImage}" alt="${lead.name}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
										<span class="hidden">${initials}</span>
									</div>
									<div>
										<div class="font-semibold text-dark dark:text-white">${escapeHtml(lead.name)}</div>
										<div class="text-sm text-link dark:text-darklink">${escapeHtml(lead.title)} at ${escapeHtml(lead.company)}</div>
									</div>
								</div>
							</td>
							<td class="px-4 py-3">
								<div class="font-semibold text-dark dark:text-white">${escapeHtml(lead.company)}</div>
								<div class="text-sm text-link dark:text-darklink">${lead.companySize} • ${escapeHtml(lead.industry)}</div>
							</td>
							<td class="px-4 py-3 text-sm text-link dark:text-darklink">${escapeHtml(lead.location)}</td>
							<td class="px-4 py-3">
								<span class="px-2 py-1 rounded text-xs font-medium ${getMatchScoreClass(lead.matchScore)}">
									${lead.matchScore}%
								</span>
							</td>
							<td class="px-4 py-3">
								<span class="px-2 py-1 rounded text-xs font-medium ${getEmailStatusClass(lead.emailStatus)}">
									${getEmailStatusLabel(lead.emailStatus)}
								</span>
							</td>
							<td class="px-4 py-3 text-sm text-link dark:text-darklink">${lead.connection}</td>
						</tr>
					`;
				}).join('');
			}

			// Get match score class
			function getMatchScoreClass(score) {
				if (score >= 80) return 'bg-lightsuccess dark:bg-darksuccess text-success';
				if (score >= 70) return 'bg-lightwarning dark:bg-darkwarning text-warning';
				return 'bg-lightsecondary dark:bg-darksecondary text-link dark:text-darklink';
			}

			// Get email status class
			function getEmailStatusClass(status) {
				switch(status) {
					case 'found':
						return 'bg-lightsuccess dark:bg-darksuccess text-success';
					case 'not-found':
						return 'bg-lightdanger dark:bg-darkdanger text-danger';
					default:
						return 'bg-lightsecondary dark:bg-darksecondary text-link dark:text-darklink';
				}
			}

			// Get email status label
			function getEmailStatusLabel(status) {
				switch(status) {
					case 'found':
						return 'Found';
					case 'not-found':
						return 'Not Found';
					default:
						return 'Unknown';
				}
			}

			// Toggle lead selection
			function toggleLeadSelection(leadId) {
				const index = selectedLeads.indexOf(leadId);
				if (index > -1) {
					selectedLeads.splice(index, 1);
				} else {
					selectedLeads.push(leadId);
				}
				updateSelectAllCheckbox();
			}

			// Toggle select all
			function toggleSelectAll(checked) {
				if (checked) {
					selectedLeads = filteredLeads.map(lead => lead.id);
				} else {
					selectedLeads = [];
				}
				document.querySelectorAll('.lead-checkbox').forEach(cb => cb.checked = checked);
				document.getElementById('select-all-checkbox').checked = checked;
				document.getElementById('table-select-all').checked = checked;
			}

			// Update select all checkbox
			function updateSelectAllCheckbox() {
				const allChecked = filteredLeads.length > 0 && selectedLeads.length === filteredLeads.length;
				document.getElementById('select-all-checkbox').checked = allChecked;
				document.getElementById('table-select-all').checked = allChecked;
			}

			// Escape HTML
			function escapeHtml(text) {
				if (!text) return '';
				const div = document.createElement('div');
				div.textContent = text;
				return div.innerHTML;
			}

			// Initialize on page load
			document.addEventListener('DOMContentLoaded', function() {
				loadLeads();
				
				// Add search input listener
				document.getElementById('search-input').addEventListener('input', applyFilters);
			});
		</script>
	</body>
</html>
