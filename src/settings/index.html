<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-theme="Green_Theme" class="selected"
	data-layout="vertical" data-boxed-layout="full" data-card="shadow">

	<head>
		@@include("../partials/head.html")
		<title>Settings - Siftin</title>
	</head>

	<body class="DEFAULT_THEME  bg-white dark:bg-dark">
		<main>
			<!--start the project-->
			<div id="main-wrapper" class="flex">

				<aside id="application-sidebar-brand"
					class="hs-overlay hs-overlay-open:translate-x-0 -translate-x-full xl:rtl:-translate-x-0 rtl:translate-x-full  left-0 rtl:left-auto rtl:right-0 transform hidden xl:block xl:translate-x-0 xl:end-auto xl:bottom-0 fixed top-0 with-vertical  left-sidebar transition-all duration-300 h-screen z-[2] flex-shrink-0 border-r rtl:border-l rtl:border-r-0 w-[270px] border-border dark:border-darkborder bg-white dark:bg-dark">
					@@include("../partials/sidebar.html",{ "page": "settings" })
				</aside>
				<div class="page-wrapper w-full" role="main">
					<!--  Header Start -->
					<header
						class="sticky top-header top-0 inset-x-0 z-[1] flex flex-wrap md:justify-start md:flex-nowrap text-sm bg-white dark:bg-dark ">
					<div
						class="with-vertical w-full">@@include("../partials/header.html")</div>
					<div class="with-horizontal w-full">
						<div class="bg-white dark:bg-dark shadow-md dark:shadow-md">
							<div class="container">
								@@include("../partials/horizontal-header.html")
							</div>
						</div>
					</div>
					</header>
					<!--  Header End -->

					<!-- Horizontal Header Menu -->
					<aside class="with-horizontal lg:flex hidden">
						@@include("../partials/horizontal-sidebar.html", { "page": "settings",
						})
					</aside>
					<!-- Horizontal Header Menu End -->

					<!-- Main Content -->
					<main class="h-full max-w-full pt-6 pb-24">
						<div class="container full-container py-5">
							<!-- Page Title -->
							<div class="mb-8">
								<div class="mb-2">
									<h1 class="text-3xl font-bold text-dark dark:text-white mb-2">Settings</h1>
									<p class="text-base text-link dark:text-darklink">Configure your workspace preferences and defaults</p>
								</div>
							</div>

							<!-- Settings Cards -->
							<div class="space-y-6">
								<!-- Workspace Settings Card -->
								<div class="card">
									<div class="card-body">
										<h2 class="text-xl font-bold text-dark dark:text-white mb-6">Workspace Settings</h2>
										
										<div class="space-y-6">
											<!-- Workspace Name -->
											<div>
												<label for="workspace-name" class="block text-sm font-semibold text-dark dark:text-white mb-2">
													Workspace Name
												</label>
												<input 
													type="text" 
													id="workspace-name" 
													value="Default Workspace"
													class="w-full px-4 py-2 border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
												/>
											</div>

											<!-- Workspace Logo -->
											<div>
												<label class="block text-sm font-semibold text-dark dark:text-white mb-2">
													Workspace Logo
												</label>
												<div class="flex items-center gap-4">
													<div class="w-16 h-16 rounded-lg bg-primary flex items-center justify-center">
														<span class="text-white text-2xl font-bold">S</span>
													</div>
													<div class="flex-1">
														<button onclick="document.getElementById('logo-upload').click()" class="btn btn-outline flex items-center cursor-pointer">
															<i class="ti ti-upload mr-2"></i> Upload Logo
														</button>
														<input type="file" id="logo-upload" accept="image/png,image/jpeg" class="hidden" onchange="handleLogoUpload(event)">
														<p class="text-xs text-link dark:text-darklink mt-2">PNG, JPG up to 2MB (demo only)</p>
													</div>
												</div>
											</div>

											<!-- Primary Color -->
											<div>
												<label for="primary-color" class="block text-sm font-semibold text-dark dark:text-white mb-2">
													Primary Color
												</label>
												<div class="flex items-center gap-3">
													<div class="w-12 h-12 rounded border border-border dark:border-darkborder" style="background-color: #2274A5;" id="primary-color-preview"></div>
													<input 
														type="text" 
														id="primary-color" 
														value="#2274A5"
														class="flex-1 px-4 py-2 border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
														onchange="updatePrimaryColor(this.value)"
													/>
													<input 
														type="color" 
														id="primary-color-picker" 
														value="#2274A5"
														class="w-12 h-12 cursor-pointer"
														onchange="updatePrimaryColorFromPicker(this.value)"
													/>
												</div>
											</div>

											<!-- Accent Color -->
											<div>
												<label for="accent-color" class="block text-sm font-semibold text-dark dark:text-white mb-2">
													Accent Color (Preview)
												</label>
												<div class="flex items-center gap-3">
													<div class="w-12 h-12 rounded border border-border dark:border-darkborder" style="background-color: #FADF63;" id="accent-color-preview"></div>
													<input 
														type="text" 
														id="accent-color" 
														value="#FADF63"
														disabled
														class="flex-1 px-4 py-2 border border-border dark:border-darkborder rounded-md bg-lightsecondary dark:bg-darksecondary text-link dark:text-darklink cursor-not-allowed"
													/>
													<input 
														type="color" 
														id="accent-color-picker" 
														value="#FADF63"
														disabled
														class="w-12 h-12 cursor-not-allowed opacity-50"
													/>
												</div>
												<p class="text-xs text-link dark:text-darklink mt-2">Accent color is fixed at #FADF63 for this prototype</p>
											</div>
										</div>
									</div>
								</div>

								<!-- Default Settings Card -->
								<div class="card">
									<div class="card-body">
										<h2 class="text-xl font-bold text-dark dark:text-white mb-6">Default Settings</h2>
										
										<div class="space-y-6">
											<!-- Dedupe Rule -->
											<div>
												<label for="dedupe-rule" class="block text-sm font-semibold text-dark dark:text-white mb-2">
													Dedupe Rule
												</label>
												<select 
													id="dedupe-rule" 
													class="w-full px-4 py-2 border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
												>
													<option value="email">Email Address</option>
													<option value="linkedin">LinkedIn URL</option>
													<option value="name-company">Name + Company</option>
												</select>
												<p class="text-xs text-link dark:text-darklink mt-2">How to identify duplicate leads during import</p>
											</div>

											<!-- Default Table Columns -->
											<div>
												<label class="block text-sm font-semibold text-dark dark:text-white mb-3">
													Default Table Columns
												</label>
												<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
													<div class="space-y-2">
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="full-name" checked>
															<span class="text-sm text-dark dark:text-white">Full Name</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="company-size">
															<span class="text-sm text-dark dark:text-white">Company Size</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="match-score" checked>
															<span class="text-sm text-dark dark:text-white">Match Score</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="tags">
															<span class="text-sm text-dark dark:text-white">Tags</span>
														</label>
													</div>
													<div class="space-y-2">
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="headline" checked>
															<span class="text-sm text-dark dark:text-white">Headline</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="industry">
															<span class="text-sm text-dark dark:text-white">Industry</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="email-status">
															<span class="text-sm text-dark dark:text-white">Email Status</span>
														</label>
													</div>
													<div class="space-y-2">
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="company" checked>
															<span class="text-sm text-dark dark:text-white">Company</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="location" checked>
															<span class="text-sm text-dark dark:text-white">Location</span>
														</label>
														<label class="flex items-center gap-2 cursor-pointer">
															<input type="checkbox" class="table-column-checkbox" value="connection-level">
															<span class="text-sm text-dark dark:text-white">Connection Level</span>
														</label>
													</div>
												</div>
											</div>

											<!-- Default Export Mapping -->
											<div>
												<label for="export-mapping" class="block text-sm font-semibold text-dark dark:text-white mb-2">
													Default Export Mapping
												</label>
												<select 
													id="export-mapping" 
													class="w-full px-4 py-2 border border-border dark:border-darkborder rounded-md bg-white dark:bg-dark text-dark dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
												>
													<option value="default-csv">Default CSV</option>
													<option value="hubspot">HubSpot</option>
													<option value="salesforce">Salesforce</option>
													<option value="pipedrive">Pipedrive</option>
												</select>
											</div>
										</div>
									</div>
								</div>

								<!-- Compliance & Privacy Card -->
								<div class="card">
									<div class="card-body">
										<div class="flex items-center gap-2 mb-4">
											<i class="ti ti-shield text-warning text-xl"></i>
											<h2 class="text-xl font-bold text-dark dark:text-white">Compliance & Privacy</h2>
										</div>
										
										<div class="bg-lightwarning dark:bg-darkwarning border border-warning rounded-md p-4">
											<div class="flex items-start gap-3">
												<i class="ti ti-alert-triangle text-warning text-xl flex-shrink-0 mt-0.5"></i>
												<div>
													<h3 class="font-semibold text-dark dark:text-white mb-2">Prototype Disclaimer</h3>
													<p class="text-sm text-link dark:text-darklink">
														This is a UI prototype only. No actual LinkedIn scraping, data collection, or storage occurs. All data shown is mock data for demonstration purposes. Any real implementation would need to comply with LinkedIn's Terms of Service, GDPR, and other applicable regulations.
													</p>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

						</div>
					</main>
					<!-- Main Content End -->

					<!-- Sticky Footer with Save Button -->
					<div class="fixed bottom-0 right-0 p-6 z-10">
						<button onclick="saveSettings()" class="btn btn-primary flex items-center cursor-pointer shadow-lg">
							<i class="ti ti-device-floppy mr-2"></i> Save Settings
						</button>
					</div>

				</div>
			</div>
			<!--end of project-->
		</main>
		@@include("../partials/header-components/mobile-menu.html")
		@@include("../partials/header-components/dd-searchbar.html")
		@@include("../partials/header-components/dd-cart.html")
		@@include("../partials/customizer.html")
		@@include("../partials/scripts.html")
		
		<script>
			// API Configuration
			const API_BASE_URL = 'http://localhost:8000';
			
			// Settings state
			let settings = {
				workspaceName: 'Default Workspace',
				primaryColor: '#2274A5',
				accentColor: '#FADF63',
				dedupeRule: 'email',
				defaultColumns: ['full-name', 'headline', 'company', 'location', 'match-score'],
				exportMapping: 'default-csv'
			};

			// Update primary color
			function updatePrimaryColor(color) {
				if (!/^#[0-9A-F]{6}$/i.test(color)) {
					return;
				}
				settings.primaryColor = color;
				document.getElementById('primary-color-preview').style.backgroundColor = color;
				document.getElementById('primary-color-picker').value = color;
			}

			// Update primary color from picker
			function updatePrimaryColorFromPicker(color) {
				settings.primaryColor = color;
				document.getElementById('primary-color').value = color;
				document.getElementById('primary-color-preview').style.backgroundColor = color;
			}

			// Handle logo upload
			function handleLogoUpload(event) {
				const file = event.target.files[0];
				if (file) {
					if (file.size > 2 * 1024 * 1024) {
						alert('File size must be less than 2MB');
						return;
					}
					
					const reader = new FileReader();
					reader.onload = function(e) {
						const logoPreview = document.querySelector('.w-16.h-16.rounded-lg');
						if (logoPreview) {
							logoPreview.style.backgroundImage = `url(${e.target.result})`;
							logoPreview.style.backgroundSize = 'cover';
							logoPreview.style.backgroundPosition = 'center';
							logoPreview.innerHTML = '';
						}
					};
					reader.readAsDataURL(file);
				}
			}

			// Save settings
			async function saveSettings() {
				// Collect all settings
				settings.workspaceName = document.getElementById('workspace-name').value;
				settings.primaryColor = document.getElementById('primary-color').value;
				settings.dedupeRule = document.getElementById('dedupe-rule').value;
				settings.exportMapping = document.getElementById('export-mapping').value;
				
				// Get selected table columns
				const selectedColumns = Array.from(document.querySelectorAll('.table-column-checkbox:checked')).map(cb => cb.value);
				settings.defaultColumns = selectedColumns;
				
				try {
					// In a real app, you'd save to API
					// await apiCall('/api/settings', 'POST', settings);
					
					// Show success message
					alert('Settings saved successfully!');
					console.log('Settings saved:', settings);
				} catch (error) {
					alert('Failed to save settings: ' + error.message);
					console.error('[Settings] Error saving:', error);
				}
			}

			// Load settings
			async function loadSettings() {
				try {
					// In a real app, you'd load from API
					// const response = await apiCall('/api/settings');
					// settings = response.settings || settings;
					
					// Apply settings to form
					document.getElementById('workspace-name').value = settings.workspaceName;
					document.getElementById('primary-color').value = settings.primaryColor;
					document.getElementById('primary-color-picker').value = settings.primaryColor;
					document.getElementById('primary-color-preview').style.backgroundColor = settings.primaryColor;
					document.getElementById('dedupe-rule').value = settings.dedupeRule;
					document.getElementById('export-mapping').value = settings.exportMapping;
					
					// Set table column checkboxes
					document.querySelectorAll('.table-column-checkbox').forEach(cb => {
						cb.checked = settings.defaultColumns.includes(cb.value);
					});
				} catch (error) {
					console.error('[Settings] Error loading:', error);
				}
			}

			// Initialize on page load
			document.addEventListener('DOMContentLoaded', function() {
				loadSettings();
			});
		</script>
	</body>
</html>
